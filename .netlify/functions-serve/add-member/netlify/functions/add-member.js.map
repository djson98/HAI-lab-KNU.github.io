{
  "version": 3,
  "sources": ["../../../../../../Users/sondongju/Desktop/demo/gatsby-starter-blog/netlify/functions/add-member.ts"],
  "sourceRoot": "/var/folders/tl/trsf7hpd5y10n74sfyh4ybwm0000gn/T/tmp-7637-tho5uw4WAdbS",
  "sourcesContent": ["import { Handler } from '@netlify/functions';\nimport * as fs from 'fs';\nimport * as path from 'path';\n\ninterface Member {\n  name: string;\n  position: string;\n  email: string;\n  photo: string;\n  homepage: string;\n  googleScholar: string;\n  graduation?: string;\n  current?: string;\n  research_interests: string[];\n}\n\ninterface RequestBody {\n  member: Member;\n}\n\nconst handler: Handler = async (event, context) => {\n  console.log('Function called with method:', event.httpMethod);\n  console.log('Event body:', event.body);\n  \n  // CORS \uD5E4\uB354 \uC124\uC815\n  const headers = {\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Headers': 'Content-Type',\n    'Access-Control-Allow-Methods': 'POST, OPTIONS',\n  };\n\n  // OPTIONS \uC694\uCCAD \uCC98\uB9AC (CORS preflight)\n  if (event.httpMethod === 'OPTIONS') {\n    console.log('Handling OPTIONS request');\n    return {\n      statusCode: 200,\n      headers,\n      body: '',\n    };\n  }\n\n  // POST \uC694\uCCAD\uB9CC \uD5C8\uC6A9\n  if (event.httpMethod !== 'POST') {\n    console.log('Method not allowed:', event.httpMethod);\n    return {\n      statusCode: 405,\n      headers,\n      body: JSON.stringify({ error: 'Method not allowed' }),\n    };\n  }\n\n  try {\n    console.log('Event body:', event.body);\n    const { member }: RequestBody = JSON.parse(event.body || '{}');\n    console.log('Parsed member:', member);\n    \n    if (!member || !member.name) {\n      console.log('Missing member name');\n      return {\n        statusCode: 400,\n        headers,\n        body: JSON.stringify({ error: 'Member name is required' }),\n      };\n    }\n\n    // \uB9C8\uD06C\uB2E4\uC6B4 \uD30C\uC77C \uC0DD\uC131\n    const researchInterestsText = member.research_interests && member.research_interests.length > 0 \n      ? member.research_interests.map(interest => `- ${interest}`).join('\\n')\n      : '- '\n\n    const markdownContent = `---\nname: \"${member.name}\"\nposition: \"${member.position}\"\nemail: \"${member.email}\"\nphoto: \"${member.photo}\"\nhomepage: \"${member.homepage}\"\ngoogleScholar: \"${member.googleScholar}\"\nresearch_interests:\n${researchInterestsText}\n---\n\n# ${member.name}\n\n## \uC18C\uAC1C\n${member.position}\n\n## \uC5F0\uB77D\uCC98\n- \uC774\uBA54\uC77C: ${member.email}\n${member.homepage ? `- \uD648\uD398\uC774\uC9C0: [${member.homepage}](${member.homepage})` : ''}\n${member.googleScholar ? `- Google Scholar: [\uD504\uB85C\uD544 \uBCF4\uAE30](${member.googleScholar})` : ''}\n\n## \uC5F0\uAD6C \uAD00\uC2EC\uC0AC\n${member.research_interests && member.research_interests.length > 0 \n  ? member.research_interests.map(interest => `- ${interest}`).join('\\n')\n  : '- \uC544\uC9C1 \uC5F0\uAD6C \uAD00\uC2EC\uC0AC\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.'\n}\n\n${member.graduation ? `## \uD559\uB825\\n- \uC878\uC5C5: ${member.graduation}` : ''}\n${member.current ? `## \uD604\uC7AC\\n- ${member.current}` : ''}\n`;\n\n    // \uAC04\uB2E8\uD55C \uD30C\uC77C\uBA85 \uC0DD\uC131\n    const timestamp = Date.now();\n    const fileName = `member-${timestamp}.md`;\n    const filePath = path.join(process.cwd(), 'content', 'members', fileName);\n\n    // content/members \uD3F4\uB354\uAC00 \uC5C6\uC73C\uBA74 \uC0DD\uC131\n    const membersDir = path.join(process.cwd(), 'content', 'members');\n    if (!fs.existsSync(membersDir)) {\n      fs.mkdirSync(membersDir, { recursive: true });\n    }\n\n    // \uD30C\uC77C \uC0DD\uC131\n    fs.writeFileSync(filePath, markdownContent, 'utf8');\n\n    // Gatsby\uAC00 \uD30C\uC77C \uBCC0\uACBD\uC744 \uAC10\uC9C0\uD560 \uC218 \uC788\uB3C4\uB85D \uC57D\uAC04\uC758 \uC9C0\uC5F0 \uD6C4 \uD30C\uC77C \uC218\uC815\n    setTimeout(() => {\n      try {\n        const stats = fs.statSync(filePath);\n        fs.utimesSync(filePath, stats.atime, new Date());\n      } catch (error) {\n        console.log('File touch failed:', error);\n      }\n    }, 100);\n\n    return {\n      statusCode: 200,\n      headers,\n      body: JSON.stringify({ \n        success: true, \n        message: '\uBA64\uBC84\uAC00 \uC131\uACF5\uC801\uC73C\uB85C \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.',\n        fileName: fileName,\n        filePath: filePath\n      }),\n    };\n\n  } catch (error) {\n    console.error('Error adding member:', error);\n    return {\n      statusCode: 500,\n      headers,\n      body: JSON.stringify({ \n        error: 'Failed to add member',\n        details: error instanceof Error ? error.message : 'Unknown error'\n      }),\n    };\n  }\n};\n\nexport { handler };\n"],
  "mappings": "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",
  "names": []
}
